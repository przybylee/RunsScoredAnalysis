 \documentclass [52pt] {article}
\usepackage{amsthm}
\usepackage[margin=1in]{geometry}
\usepackage{inputenc}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{afterpage}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue
    }
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\upn}{^{(n)}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\basis}{\text{span}}
\newcommand{\Hil}{\mathbf{H}}
\newcommand{\trace}{\text{trace}}
\usepackage{ams symb}
\usepackage{enumerate}
\usepackage{amsrefs}
\usepackage{graphicx}
\usepackage{listings}
%\graphicspath{{Applied Math II (Spring 2018)}}
%Here are some prob and stat commands:
\newcommand{\var}{\text{var}}
\newcommand{\cov}{\text{cov}}
\newcommand{\Exp}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\simind}{\overset{\text{ind}}{\sim}}
\newcommand{\simiid}{\overset{\text{iid}}{\sim}}
\DeclareMathOperator{\diag}{diag}
\title{Measuring the Effects of Starting Pitching}
\author{Lee Przybylski}


\begin{document}

\maketitle
\abstract{Betting on baseball is challenging.  One feature that makes the sport different is that moneylines usually list probable starting pitchers.  To take advantage of this, we develop a generalized linear mixed effects model using retrosheet data from several seasons.  The model includes effects for teams, starting pitchers, and venue.  Being able to assess a pitcher's performance independent of his team is also challenging.  By estimating effects for each starting pitcher, fitting the model provides another way measure a starting pitcher's effectiveness.  We also provide some background on pitching metrics that have been used in the past, such as ERA, FIP, and oppent WOBA, and compare these metrics to our estimated pitcher effects.}


\section{Introduction}

When looking to wager on the outcome of a baseball game, your sports book will usually offer three options.  You can be the runline, which places a handicap on the teams based on their estimated margin of victory.  A team with a negative runline is favored to win.  You can bet the moneyline, where there is no restrictions on the margin of victory.  Your only objective is to bet on the team that wins.  The moneyline indicates how much risk you take on.  A favored team will have a negative moneyline, and its absolute value will equal the amount needed to wager in order to win \$100.  The underdog will have a positive moneyline and equal the the amount won for a successful \$100 wager.  Finaly, you can bet the over-under, which is like a runline in that you predict the total number of runs scored in the game.
\begin{figure}[h!]
    \centering
    \includegraphics[scale = 0.7]{mlb-odds-2.png}
    %\caption{Caption}
    %\label{fig:my_label}
\end{figure}

We also see that the sportsbook indicates the probable starting pitchers.  We can build a regression model that will leverage the effects of starting pitchers to hopefully better predict the outcome of games.  Using the proper approach, we also can use predictors from this model to make better comparisons of starting pitchers while considering the context of who they are pitching against, where they are playing, and the quality of the defense behind them.  We will fit this model using sportsbook archive data  taken from \href{https://www.sportsbookreviewsonline.com/scoresoddsarchives/mlb/mlboddsarchives.htm}{sportsbookreviewsonline.com}.  We will compare our ratings of pitchers to other metrics such as ERA, FIP, WAR, and DRA as reported by \href{https://www.baseballprospectus.com/leaderboards/pitching/}{Baseball Prospectus}.

\section{Model Selection}

\subsection{Overdispersion}

When we use regression to fit a generalized linear model (GLM) with an exponential family of distributions, it is usually the case that the variance of our distribution is a function of the mean of the distribution.  Recall that a Poisson distribution with mean $\lambda>0$, denoted $\text{poiss}(\lambda)$, has pmf
\[f(x) = \frac{e^{-\lambda}\lambda^x}{x!},\:\:x\in\N_0.\]
Through a link function, we can use ordinary least squares to find an estimate for the mean based on the covariates, but often variance implied by this estimated mean is too small to explain the variation observed in the data.  When this happens, we say that the model has \emph{overdispersion}.  This must be accounted for in order to perform meaningful inference.  There are 2 common ways to deal with overdispersion.
\begin{itemize}
\item We can add a dispersion parameter to the model which is estimated using a quasi-likelihood approach.
\item We can fit a generalized linear mixed effects model (GLMEM) where we assume the mean is also affected by a centered normal random variable. 
\end{itemize}
Here we will elect to follow the second approach.

\subsection{Model Definitions}
Let $y_{ijklm}$ be the number of runs scored by team $i$ against team $j$ at venue $k$ facing starting pitcher $l$ during the $m$th game of the season.  The model we propose assumes that $y_{ijklm}\sim\text{Poisson}(\lambda_{ijklm})$ where
\begin{equation}\label{eq : model1}
\log(\lambda_{ijklm}) = \mu + \chi \mathbf{1}_{im} + b_i + f_j + v_k + p_l + g_m + e_{im},
\end{equation}
\[b_i\simiid N(0,\sigma^2_b), f_j\simiid N(0,\sigma^2_f), v_k\simiid N(0,\sigma^2_v), p_l\simiid N(0, \sigma^2_p),\:\:g_m\simiid N(0, \sigma^2_g), e_{im}\simiid N(0,\sigma^2_e).\]
\[\mathbf{1}_{im} = \begin{cases}
1 & \text{if team}\:i\:\text{is home during game}\:m\\
0 &\text{otherwise}
\end{cases}\]

\subsection{Validation Testing}

\section{Pitcher Effects}

\subsection{Noteworthy Pitchers}

\subsection{Comparison with Other Metrics}


\end{document}